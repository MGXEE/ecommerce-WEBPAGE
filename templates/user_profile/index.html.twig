{% extends 'base.html.twig' %} {% block title %}Your Profile{% endblock %} {%
block body %}
<div class="container mt-5">
    <h1>Edit Profile</h1>

    {% for message in app.flashes('success') %}
    <div class="alert alert-success">{{ message }}</div>
    {% endfor %}

    {{ form_start(form) }}
    {{ form_widget(form) }}
    <div class="d-flex gap-3 mt-3">
        <button class="btn btn-primary">Save changes</button>

        <form
            action="{{ path('app_user_profile_delete') }}"
            method="POST"
            onsubmit="return confirm('Are you sure you want to delete your account? This action cannot be undone?')"
        >
            <input type="hidden" name="_token" value="{{ delete_token }}" />
            <button type="submit" class="btn btn-danger">
                Delete My Account
            </button>
        </form>
    </div>
    {{ form_end(form) }}

    {# only admins can see & edit the userlist #} {% if is_granted('ROLE_ADMIN')
    %}
    <hr />

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>All Users</h2>
        <a href="{{ path('admin_user_new') }}" class="btn btn-success"
            >+ Create New User-Profile</a
        >
    </div>

    <div class="row">
        {% for user in users %}
        <div class="card col-md-4 mb-3" style="padding: 10px">
            <div><strong>ID:</strong> {{ user.id }}</div>
            <div><strong>Email:</strong> {{ user.email }}</div>
            <div><strong>Name:</strong> {{ user.fname }} {{ user.lname }}</div>
            <a
                href="{{ path('admin_edit_user', { id: user.id }) }}"
                class="btn btn-secondary btn-sm mt-2"
                >Edit User</a
            >
        </div>

        {% else %}
        <p>No users found.</p>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}
